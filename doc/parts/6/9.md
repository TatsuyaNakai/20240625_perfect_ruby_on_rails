## 関連とフックの関係性

before_destroyコールバックは、dependent: :destroyよりも前に配置する。もしくは、`prepend: true`オプションを記述する必要があります。

もし記述しない場合は、before_destroyが関連付けのオプションよりも後に実行されてしまいます。
例えば、dependent: :destroyを書いている場合、before_destroyを実行する前に関連レコードは削除されます。

~~~~Ruby
class User < ApplicationRecord
  # 関連
  has_many :events, foreign_key: 'owner_id', dependent: :nullify
  has_many :tickets, dependent: :nullify
  has_many :participating_events, through: :tickets, source: :event

  # フック
  before_destroy :check_all_events_finished, prepend: true # オプションを追記します。
  ...
end
~~~~

[参照] 　[Railsガイド](https://railsguides.jp/active_record_callbacks.html#%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AEdestroy)
