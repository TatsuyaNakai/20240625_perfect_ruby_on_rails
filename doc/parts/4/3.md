## Railsに組み込まれているJavaScriptの機能

JavaScriptでのHTMLの制御や画面遷移を制御する方法が提供されています。


### rails-ujs

Submitボタンを押下した時にダイアログを表示したり、二重送信しないような制御が搭載されています。

JavaScriptを書かなくても、Railsのヘルパーに少しの記述をするだけで実現することができます。


### Ajax通信

ページ操作が可能な状態(非同期処理)でサーバーとのやり取りを行う事ができます。

formのヘルパーメソッドのオプションにて`remote: true`とすることで、非同期処理として扱う事ができます。


### Turbolinks

Ajaxのリクエストで取得したHTMLデータのbodyタグを現在のページに反映させることで高速なページ遷移を可能としています。

「ページの内容が変わってるんだから、普通の画面遷移と同じでは？」と考えるかもしれませんが、headタグなどのリクエストを行っていないため、無駄がなく、素早い画面反映が行えることがポイントになります。

Turbolinksがプロジェクトに合わない、不要である。と判断する場合は、rails new時にオプションで省く事ができます。

```
$ rails new sample_app --skip-turbolinks
```

**bodyのタグを入れ替えることで画面遷移っぽいことをしている**との事なので、ブラウザ自体の読み込みは初回時に完了しています。

そのため、`onload`や`DOMContentLoaded`といったイベントが発火しないということです。それだと、不便なケースがあるので、Turbolinks独自のタイミングで発火するイベントが用意されています。

|  |  |
| --- | --- |
| turbolinks:load | 最初に画面を表示したタイミングと、Tubolinksによってbody部分が切り替わった場合に発火 |

他にも[Turbolinks](https://github.com/turbolinks/turbolinks?tab=readme-ov-file#full-list-of-events)公式にてイベントが用意されているので、必要な時は確認してください。

便利な面だけでなく、Ajax通信の場合は、JSON形式でデータを返却してあげた方がよく、工夫が必要になります。詳細は[こちら](https://railsguides.jp/v6.0/working_with_javascript_in_rails.html#%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E5%81%B4%E3%81%A7%E8%80%83%E6%85%AE%E3%81%99%E3%81%B9%E3%81%8D%E7%82%B9)に記載してあります。
